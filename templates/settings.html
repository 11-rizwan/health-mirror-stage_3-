{% extends "base.html" %}
{% block title %}User Settings{% endblock %}

{% block content %}
<section class="section-padding">
<div class="container text-page-container" style="max-width: 600px;"> <h1 class="section-title animate-slide-in">User Settings</h1>

    <div class="card animate-slide-in">
        <h2>Account Information</h2>
        <div class="form-group">
            <label>Username</label>
            <input type="text" value="{{ user.username }}" readonly>
        </div>
        <div class="form-group">
            <label>Team</label>
            <input type="text" value="{{ team.name if team else 'N/A' }}" readonly>
        </div>
         <div class="form-group">
            <label>Role</label>
            <input type="text" value="{{ user.role.capitalize() }}" readonly>
        </div>
    </div>

    <div class="card animate-slide-in">
        <h2>Change Password</h2>
        <form method="POST" action="{{ url_for('settings') }}" id="password-change-form">
            <div class="form-group">
                <label for="current_password">Current Password</label>
                <input type="password" id="current_password" name="current_password" required>
            </div>
            <div class="form-group">
                <label for="new_password">New Password</label>
                <input type="password" id="new_password" name="new_password" required minlength="6">
                 <small>Minimum 6 characters</small>
            </div>
            <div class="form-group">
                <label for="confirm_password">Confirm New Password</label>
                <input type="password" id="confirm_password" name="confirm_password" required minlength="6">
            </div>
            <button type="submit" class="btn" style="width: 100%;">Update Password</button>
        </form>
    </div>
</div>
</section>

<script>
    const form = document.getElementById('password-change-form');
    const newPassword = document.getElementById('new_password');
    const confirmPassword = document.getElementById('confirm_password');

    form.addEventListener('submit', function(event) {
        if (newPassword.value !== confirmPassword.value) {
            alert('New passwords do not match.');
            event.preventDefault(); // Prevent form submission
        }
        // Basic length check (browser already does minlength, but good practice)
        if (newPassword.value.length < 6) {
             alert('New password must be at least 6 characters long.');
             event.preventDefault();
        }
    });
</script>
{% endblock %}